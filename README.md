# StrainCraft
This is a small program that deals with raw data from the Rigol DS oscilloscope recording signals from the wheatstone bridges on the SHPB.

**StrainCraft** — это графический интерфейс на Python для анализа и визуализации данных испытаний с установки *Разрезного Стержня Гопкинсона* (*Split Hopkinson Pressure Bar*). Программа позволяет загружать параметры установки и журналы испытаний, выполнять препроцессинг данных и строить различные графики для анализа напряженно-деформированного состояния образцов.

## Возможности

- Загрузка параметров установки из JSON
- Импорт журнала испытаний из Excel (.xlsx)
- Визуализация:
  - Исходных сигналов (CH1, CH2) с калибровочной линией
  - Баланса импульсов (I, R, T, I+R)
  - Истинной диаграммы напряжение-деформация
  - Деформаций и скоростей деформаций (strain, strain rate)
- Настройка сглаживания, нулевого уровня и триггера (параметры препроцессора)
- Выбор и удаление образцов из таблицы
- Сохранение данных активных образцов в Excel-файл

## Основные зависимости

- `PyQt5`
- `matplotlib`
- `seaborn`
- `pandas`
- `numpy`
- `openpyxl`

Установка всех зависимостей:

```bash
pip install -r requirements.txt
```

**`requirements.txt`:**

```
PyQt5
matplotlib
seaborn
pandas
numpy
openpyxl
```

## Структура проекта

```
├── main.py                  # Основной GUI код
├── Core/
│   └── Specimen.py          # Модель обработки данных одного образца
├── requirements.txt         # Список зависимостей
└── README.md                # Этот файл
```

## Запуск через терминал

```bash
python GUI.py
```

## Руководство

1. **Загрузите параметры установки:**
   - Нажмите кнопку «Загрузить параметры из JSON» и выберите JSON-файл с параметрами.

2. **Загрузите журнал испытаний:**
   - Нажмите «Загрузить журнал испытаний (xlsx)» и выберите Excel-файл с данными испытаний.
   - Образцы появятся в таблице. Можно выбрать несколько образцов для построения графиков.

3. **Настройте параметры препроцессинга:**
   - Используйте спинбоксы для установки параметров сглаживания и триггера.
   - Нажмите «Обновить препроцессинг» для применения изменений ко всем образцам.

4. **Стройте графики:**
   - Выберите нужные образцы в таблице и используйте соответствующие кнопки:
     - **Построить весь сигнал**
     - **Построить баланс**
     - **Построить диаграмму**
     - **Построить деформации**
     - **Сохранить выбранные образцы в Excel**

## Примечания

- В коде используется внешний класс `Specimen` из модуля `Core.py`. Убедитесь, что этот файл находится в той же директории или укажите правильный путь.
- Журнал испытаний должен содержать столбец `filename` с именами файлов данных. Пути автоматически дополняются до полного пути.

- The crucial columns in `notebook.xlsx` are as follows.

| V0_CH1/V | V0_CH2/V | H_s/mm | v/m//s | striker/сm | filename |
| ---      |  ---     |  ---   | ---    | ---       | ---      |
| 19.8     | 20.1     | 5      | 5.6    | 60        | Al.csv   |

- The each `rawdata.csv` file contains three columns.

| Time(s) | CH1(V) | CH2(V) |
| ---     | ---    | ---    |
| 0.0000  | 0.0000 | 0.0000 |

- The `properties.json` contains record of bars parameters that stays mostly permanent.

| parameter | description                                       |
|---        |---                                                |
|K/MPa//mV  | sensitivity of WB                                 |
|d/mm       | bars diameter                                     |
|rho/kg//m3 | bars density                                      |
|E/GPa      | bars Young modulus                                |
|L1/m       | distance from the end of the rod to the first WB  |
|L2/m       | distance from the end of the rod to the second WB |



